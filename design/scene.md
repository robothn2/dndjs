# 场景数据化
MMORPG游戏在客户端的呈现来看有下面几种：
- 不变对象，场景的固定数据
  - 地形(Terrain)
- 可配置对象，场景的配置数据
  - NPC生物(Creature)，可以绑定脚本，可以自主移动，可释放法术
  - 静态物体(StaticObject)，可以绑定脚本，不可自主移动
- 动态创建对象
  - 玩家(Player)，可以被一个客户端远程控制，可以自主移动，可释放法术
  - 发射物(Bullet)，法术的各种发射物

---
对象继承关系
- Placeable : ScriptHost，加这一层是为了共用部分可放置于场景内的对象的处理逻辑
  - StaticObject
  - Unit : SpellCaster
    - Player
    - Creature


# 场景实现
MUD 类游戏的 Room 可以被视为 0 维空间，其内的单位彼此可以视为无距离，不同 Room 内的单位无法战斗和交互
3D MMO 场景会将整个场景分为 Tiles，作用如下：
- 服务端：
  - 在玩家说话(Say), 做动作(Emotion)，施法等可视化操作时，需要将操作广播给附近的所有玩家，而不是地图内所有玩家
  - 在玩家移动时，将玩家自身出现和消失信息广播给附近玩家，也将移动目的区域的玩家、NPC等信息发送给玩家
- 客户端：

# 数据的传输优化
为了达到最大的扩展性，当然选择要把所有的数据都放在服务端，在玩家进入世界后，服务器将所有数据都发送给客户端。
但服务器带宽终究是有限的，面对庞大的数据，只能将部分数据下放给客户端，下面分析下哪些数据应该存放到客户端：
- 场景 mesh 数据，用于渲染
- 各种材质、贴图数据
- 国际化文本，例如：NPC名字、种类、对话文本
- 数据显示界面
服务器持有下面的数据：
- 场景导航数据(navmesh)，用于寻路
- 场景 mesh 简化数据(physics)，用于NPC摆放，可见性检查、水体区域检查
- 场景内的 NPC，静态物体刷新点、外观、逻辑
- 其它游戏子任务逻辑

# 实现 NPC 行为
通过行为模式来抽象出单位的通用行为逻辑

通过状态机来支持多种行为模式变化路径

---
通过状态栈来支持行为模式恢复，考虑下面两种情况：1.NPC正在巡逻时，发现Player，开始战斗，Player逃跑脱离战斗后，NPC需要继续巡逻；2.更进一步，NPC和Player战斗时被恐惧，恐惧完毕后要继续战斗，Player逃跑后继续巡逻。这些情况下我们可以使用行为模式栈

# 如何让 NPC 行为更智能


# 让角色动起来

# 动作知多少

# 如何设计动作
